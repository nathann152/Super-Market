{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Natan/Desktop/Project 4/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ProductModel } from 'src/app/models/product';\nimport { store } from 'src/app/redux/store';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/products.service\";\nimport * as i2 from \"src/app/services/admin.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/button\";\n\nfunction AdminComponent_div_3_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵelement(6, \"img\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function AdminComponent_div_3_tr_16_Template_button_click_8_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const p_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.goToEditProduct(p_r3._id));\n    });\n    i0.ɵɵtext(9, \"Edit\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const p_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r3.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r3.price);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"http://localhost:3010/api/products/image/\", p_r3.img, \"\", i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction AdminComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 1);\n    i0.ɵɵlistener(\"click\", function AdminComponent_div_3_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.goToAddProduct());\n    });\n    i0.ɵɵtext(2, \"Add Product\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵelementStart(4, \"table\")(5, \"thead\")(6, \"tr\")(7, \"th\");\n    i0.ɵɵtext(8, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"Edit\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"tbody\");\n    i0.ɵɵtemplate(16, AdminComponent_div_3_tr_16_Template, 10, 3, \"tr\", 2);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(16);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.products);\n  }\n}\n\nfunction AdminComponent_form_5_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Missing Name !\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AdminComponent_form_5_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"At least 3 letters\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AdminComponent_form_5_span_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Missing price !\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AdminComponent_form_5_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const c_r18 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", c_r18._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(c_r18.name);\n  }\n}\n\nfunction AdminComponent_form_5_button_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function AdminComponent_form_5_button_23_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r19.updateProduct());\n    });\n    i0.ɵɵtext(1, \"Update\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r8 = i0.ɵɵreference(1);\n\n    i0.ɵɵproperty(\"disabled\", _r8.form.invalid);\n  }\n}\n\nfunction AdminComponent_form_5_button_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function AdminComponent_form_5_button_24_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r21.addProduct());\n    });\n    i0.ɵɵtext(1, \"Add\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r8 = i0.ɵɵreference(1);\n\n    i0.ɵɵproperty(\"disabled\", _r8.form.invalid);\n  }\n}\n\nfunction AdminComponent_form_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", null, 5)(2, \"label\", 6);\n    i0.ɵɵtext(3, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 7, 8);\n    i0.ɵɵlistener(\"ngModelChange\", function AdminComponent_form_5_Template_input_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.product.name = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, AdminComponent_form_5_span_6_Template, 2, 0, \"span\", 0);\n    i0.ɵɵtemplate(7, AdminComponent_form_5_span_7_Template, 2, 0, \"span\", 0);\n    i0.ɵɵelementStart(8, \"label\", 6);\n    i0.ɵɵtext(9, \"Price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"input\", 9, 10);\n    i0.ɵɵlistener(\"ngModelChange\", function AdminComponent_form_5_Template_input_ngModelChange_10_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.product.price = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, AdminComponent_form_5_span_12_Template, 2, 0, \"span\", 0);\n    i0.ɵɵelementStart(13, \"label\", 6);\n    i0.ɵɵtext(14, \"Category\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"select\", 11, 12);\n    i0.ɵɵlistener(\"ngModelChange\", function AdminComponent_form_5_Template_select_ngModelChange_15_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r26.product.categoryId = $event);\n    });\n    i0.ɵɵtemplate(17, AdminComponent_form_5_option_17_Template, 2, 2, \"option\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"label\", 6);\n    i0.ɵɵtext(19, \"Image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"input\", 14);\n    i0.ɵɵlistener(\"input\", function AdminComponent_form_5_Template_input_input_20_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.updateImg($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function AdminComponent_form_5_Template_button_click_21_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r28 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r28.goBack());\n    });\n    i0.ɵɵtext(22, \"Go back\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(23, AdminComponent_form_5_button_23_Template, 2, 1, \"button\", 16);\n    i0.ɵɵtemplate(24, AdminComponent_form_5_button_24_Template, 2, 1, \"button\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const _r9 = i0.ɵɵreference(5);\n\n    const _r12 = i0.ɵɵreference(11);\n\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.product.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (_r9.errors == null ? null : _r9.errors[\"required\"]) && _r9.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (_r9.errors == null ? null : _r9.errors[\"minlength\"]) && _r9.touched);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.product.price);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (_r12.errors == null ? null : _r12.errors[\"required\"]) && _r12.touched);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.product.categoryId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.categories);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.editProduct);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.newProduct);\n  }\n}\n\nexport class AdminComponent {\n  constructor(myProductsService, adminService, router) {\n    this.myProductsService = myProductsService;\n    this.adminService = adminService;\n    this.router = router;\n    this.product = new ProductModel();\n    this.categories = [];\n    this.newProduct = false;\n    this.editProduct = false;\n  }\n\n  ngOnInit() {\n    store.subscribe(() => {\n      this.user = store.getState().user;\n    });\n    this.myProductsService.getAllProducts().subscribe(res => this.products = res, err => alert(err.message));\n    this.adminService.getAllCategories().subscribe(res => this.categories = res, err => alert(err.message));\n  } // public addProduct(): void {\n  //     if (!this.product.img) {\n  //         alert('You have to upload image !');\n  //         return;\n  //     }\n  //     const myForm: FormData = new FormData();\n  //     myForm.append('image', this.product.img);\n  //     myForm.append('product', JSON.stringify(this.product));\n  //     this.adminService.addProduct(myForm)\n  //         .subscribe(res => {\n  //             this.products.push(res);\n  //             alert('product has been added !');\n  //             this.goBack();\n  //         }, err => alert(err.message));\n  // }\n\n\n  addProduct() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        _this.adminService.addProduct(_this.product);\n\n        alert('product has been added !');\n\n        _this.router.navigateByUrl(\"/admin\");\n      } catch (err) {\n        alert(err.message);\n      }\n    })();\n  }\n\n  updateImg(event) {\n    this.product.img = event.target.files[0];\n  }\n\n  goToEditProduct(_id) {\n    this.editProduct = true;\n    const selectedProduct = this.products.find(p => p._id === _id);\n    this.product = selectedProduct;\n  }\n\n  goToAddProduct() {\n    this.newProduct = true;\n  }\n\n  updateProduct() {\n    const myForm = new FormData();\n    myForm.append('image', this.product.img);\n    myForm.append('product', JSON.stringify(this.product));\n    this.adminService.updateProduct(myForm).subscribe(res => {\n      const index = this.products.findIndex(product => product._id === res._id);\n      this.products[index] = res;\n      alert('product has been updated!');\n      this.goBack();\n    }, err => alert(err.message));\n  }\n\n  goBack() {\n    this.newProduct = false;\n    this.editProduct = false;\n    this.product = new ProductModel();\n  }\n\n}\n\nAdminComponent.ɵfac = function AdminComponent_Factory(t) {\n  return new (t || AdminComponent)(i0.ɵɵdirectiveInject(i1.ProductsService), i0.ɵɵdirectiveInject(i2.AdminService), i0.ɵɵdirectiveInject(i3.Router));\n};\n\nAdminComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AdminComponent,\n  selectors: [[\"app-admin\"]],\n  decls: 6,\n  vars: 2,\n  consts: [[4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", \"btn-info\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [\"alt\", \"\", 3, \"src\"], [\"mat-raised-button\", \"\", 3, \"click\"], [\"productForm\", \"ngForm\"], [1, \"col-md-4\"], [\"type\", \"text\", \"name\", \"name\", \"minlength\", \"3\", \"maxlength\", \"30\", \"required\", \"\", 1, \"form-control\", \"col-md-4\", 3, \"ngModel\", \"ngModelChange\"], [\"productName\", \"ngModel\"], [\"type\", \"number\", \"name\", \"price\", \"minlength\", \"3\", \"maxlength\", \"30\", \"required\", \"\", 1, \"form-control\", \"col-md-4\", 3, \"ngModel\", \"ngModelChange\"], [\"productPrice\", \"ngModel\"], [\"name\", \"category\", \"id\", \"inputGroupSelect01 col-md-4\", \"required\", \"\", 1, \"custom-select\", 3, \"ngModel\", \"ngModelChange\"], [\"productCategory\", \"ngModel\"], [\"name\", \"citiesSelect\", 3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"file\", \"name\", \"imageFile\", \"accept\", \"image/*\", \"multiple\", \"multiple\", 1, \"form-control\", \"col-md-4\", 3, \"input\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [\"class\", \"btn btn-dark\", \"type\", \"button\", 3, \"disabled\", \"click\", 4, \"ngIf\"], [\"class\", \"\", \"type\", \"button\", 3, \"disabled\", \"click\", 4, \"ngIf\"], [\"name\", \"citiesSelect\", 3, \"value\"], [\"type\", \"button\", 1, \"btn\", \"btn-dark\", 3, \"disabled\", \"click\"], [\"type\", \"button\", 1, \"\", 3, \"disabled\", \"click\"]],\n  template: function AdminComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\");\n      i0.ɵɵtext(1, \"Admin Panel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(2, \"hr\");\n      i0.ɵɵtemplate(3, AdminComponent_div_3_Template, 17, 1, \"div\", 0);\n      i0.ɵɵelementStart(4, \"div\");\n      i0.ɵɵtemplate(5, AdminComponent_form_5_Template, 25, 9, \"form\", 0);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", !ctx.newProduct && !ctx.editProduct);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.newProduct || ctx.editProduct);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.NumberValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.MinLengthValidator, i5.MaxLengthValidator, i5.NgModel, i5.NgForm, i6.MatButton],\n  styles: [\"div[_ngcontent-%COMP%]{\\n    text-align: center;\\n}\\n\\nimg[_ngcontent-%COMP%]{\\n    height: 40px ;\\n}\\n\\ntable[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%] {\\n    border: 1px solid #ddd;\\n    text-align: center;\\n}\\n\\ntable[_ngcontent-%COMP%] {\\n    border-collapse: collapse;\\n    width: 60%;\\n    margin: 0 auto 0 auto;\\n    margin-top: 10px;\\n}\\n\\nth[_ngcontent-%COMP%], td[_ngcontent-%COMP%] {\\n    padding: 15px;\\n}\\n\\nth[_ngcontent-%COMP%] {\\n    background: #2D2D2A;\\n    color: whitesmoke;\\n    font-weight: 500;\\n}\\n\\nlabel[_ngcontent-%COMP%] {\\n    text-align: end;\\n    margin-top: 5px;\\n    font-weight: 500;\\n}\\n\\n.form-group[_ngcontent-%COMP%] {\\n    margin: 0 auto 0 auto;\\n    padding: 10px;\\n}\\n\\nh1[_ngcontent-%COMP%]{\\n    text-align: center;\\n}\\n\\nbutton[_ngcontent-%COMP%] {\\n    margin: 10px;\\n}\\n\\nform[_ngcontent-%COMP%] {\\n    width: 400px;\\n    text-align: left;\\n    padding: 10px;\\n    border: 1px solid black;\\n    margin: auto;\\n}\\n\\nh2[_ngcontent-%COMP%] {\\n    text-align: center;\\n}\\n\\nselect[_ngcontent-%COMP%], input[_ngcontent-%COMP%] {\\n    width: 100%;\\n    box-sizing: border-box;\\n    margin-bottom: 20px;\\n}\\n\\nspan[_ngcontent-%COMP%] {\\n    position: absolute;\\n    color: red;\\n    margin: 5 20px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxhQUFhO0FBQ2pCOztBQUNBO0lBQ0ksc0JBQXNCO0lBQ3RCLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLHlCQUF5QjtJQUN6QixVQUFVO0lBQ1YscUJBQXFCO0lBQ3JCLGdCQUFnQjtBQUNwQjs7QUFFQTtJQUNJLGFBQWE7QUFDakI7O0FBRUE7SUFDSSxtQkFBbUI7SUFDbkIsaUJBQWlCO0lBQ2pCLGdCQUFnQjtBQUNwQjs7QUFHQTtJQUNJLGVBQWU7SUFDZixlQUFlO0lBQ2YsZ0JBQWdCO0FBQ3BCOztBQUNBO0lBQ0kscUJBQXFCO0lBQ3JCLGFBQWE7QUFDakI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxZQUFZO0FBQ2hCOztBQUNBO0lBQ0ksWUFBWTtJQUNaLGdCQUFnQjtJQUNoQixhQUFhO0lBQ2IsdUJBQXVCO0lBQ3ZCLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxXQUFXO0lBQ1gsc0JBQXNCO0lBQ3RCLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLGtCQUFrQjtJQUNsQixVQUFVO0lBQ1YsY0FBYztBQUNsQiIsImZpbGUiOiJhZG1pbi5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiZGl2e1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuaW1ne1xuICAgIGhlaWdodDogNDBweCA7XG59XG50YWJsZSwgdGQsIHRoIHtcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjZGRkO1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxudGFibGUge1xuICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7XG4gICAgd2lkdGg6IDYwJTtcbiAgICBtYXJnaW46IDAgYXV0byAwIGF1dG87XG4gICAgbWFyZ2luLXRvcDogMTBweDtcbn1cblxudGgsIHRkIHtcbiAgICBwYWRkaW5nOiAxNXB4O1xufVxuXG50aCB7XG4gICAgYmFja2dyb3VuZDogIzJEMkQyQTtcbiAgICBjb2xvcjogd2hpdGVzbW9rZTtcbiAgICBmb250LXdlaWdodDogNTAwO1xufVxuXG5cbmxhYmVsIHtcbiAgICB0ZXh0LWFsaWduOiBlbmQ7XG4gICAgbWFyZ2luLXRvcDogNXB4O1xuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG59XG4uZm9ybS1ncm91cCB7XG4gICAgbWFyZ2luOiAwIGF1dG8gMCBhdXRvO1xuICAgIHBhZGRpbmc6IDEwcHg7XG59XG5cbmgxe1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuYnV0dG9uIHtcbiAgICBtYXJnaW46IDEwcHg7XG59XG5mb3JtIHtcbiAgICB3aWR0aDogNDAwcHg7XG4gICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICBwYWRkaW5nOiAxMHB4O1xuICAgIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xuICAgIG1hcmdpbjogYXV0bztcbn1cblxuaDIge1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuc2VsZWN0LCBpbnB1dCB7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICBtYXJnaW4tYm90dG9tOiAyMHB4O1xufVxuXG5zcGFuIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgY29sb3I6IHJlZDtcbiAgICBtYXJnaW46IDUgMjBweDtcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["ProductModel","store","i0","AdminComponent","constructor","myProductsService","adminService","router","ngOnInit","subscribe","user","getState","getAllProducts","res","products","err","alert","message","getAllCategories","categories","addProduct","product","navigateByUrl","updateImg","event","img","target","files","goToEditProduct","_id","editProduct","selectedProduct","find","p","goToAddProduct","newProduct","updateProduct","myForm","FormData","append","JSON","stringify","index","findIndex","goBack","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Natan\\Desktop\\Project 4\\Frontend\\src\\app\\components\\admin\\admin.component.ts","C:\\Users\\Natan\\Desktop\\Project 4\\Frontend\\src\\app\\components\\admin\\admin.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { UserModel } from 'src/app/models/user';\nimport { ProductsService } from 'src/app/services/products.service';\nimport { ProductModel } from 'src/app/models/product';\nimport { AdminService } from 'src/app/services/admin.service';\nimport { store } from 'src/app/redux/store';\nimport { Router } from '@angular/router';\n\n\n@Component({\n    selector: 'app-admin',\n    templateUrl: './admin.component.html',\n    styleUrls: ['./admin.component.css']\n})\nexport class AdminComponent implements OnInit {\n    public user: UserModel;\n    public products: ProductModel[];\n    public product: ProductModel = new ProductModel();\n    public categories: any = [];\n    public newProduct: boolean = false;\n    public editProduct: boolean = false;\n\n    constructor(private myProductsService: ProductsService, private adminService: AdminService,private router: Router) { }\n\n    ngOnInit(): void {\n        store.subscribe(() => {\n            this.user = store.getState().user;\n        });\n        this.myProductsService.getAllProducts()\n            .subscribe(res => this.products = res, err => alert(err.message));\n        this.adminService.getAllCategories()\n            .subscribe(res => this.categories = res, err => alert(err.message));\n    }\n\n    // public addProduct(): void {\n    //     if (!this.product.img) {\n    //         alert('You have to upload image !');\n    //         return;\n    //     }\n    //     const myForm: FormData = new FormData();\n    //     myForm.append('image', this.product.img);\n    //     myForm.append('product', JSON.stringify(this.product));\n\n    //     this.adminService.addProduct(myForm)\n    //         .subscribe(res => {\n    //             this.products.push(res);\n    //             alert('product has been added !');\n    //             this.goBack();\n    //         }, err => alert(err.message));\n    // }\n\n    public async addProduct(){\n        try{\n            this.adminService.addProduct(this.product);\n            alert('product has been added !');\n            this.router.navigateByUrl(\"/admin\");\n        }\n        catch(err:any){\n            alert(err.message);\n        }\n    }\n\n\n\n\n    public updateImg(event: any): void {\n        this.product.img = event.target.files[0];\n    }\n\n    public goToEditProduct(_id: string): void {\n        this.editProduct = true;\n        const selectedProduct = this.products.find(p => p._id === _id);\n        this.product = selectedProduct;\n    }\n\n    public goToAddProduct(): void {\n        this.newProduct = true;\n    }\n\n\n\n    public updateProduct(): void {\n        const myForm: FormData = new FormData();\n        myForm.append('image', this.product.img);\n        myForm.append('product', JSON.stringify(this.product));\n\n        this.adminService.updateProduct(myForm)\n            .subscribe(res => {\n                const index = this.products.findIndex(product => product._id === res._id);\n                this.products[index] = res;\n                alert('product has been updated!');\n                this.goBack();\n            }, err => alert(err.message))\n    }\n\n    public goBack(): void {\n        this.newProduct = false;\n        this.editProduct = false;\n        this.product = new ProductModel();\n    }\n}\n","<h1>Admin Panel</h1>\n    <hr>\n<div *ngIf='!newProduct && !editProduct'>\n    <button type=\"button\" class=\"btn btn-info\" (click)='goToAddProduct()'>Add Product</button>\n    <br>\n    <table>\n        <thead>\n            <tr>\n                <th>Name</th>\n                <th>Price</th>\n                <th>Image</th>\n                <th>Edit</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr *ngFor='let p of products'>\n                <td>{{p.name}}</td>\n                <td>{{p.price}}</td>\n                <td><img src=\"http://localhost:3010/api/products/image/{{p.img}}\" alt=''></td>\n                <td>\n                    <button mat-raised-button (click)='goToEditProduct(p._id)'>Edit</button>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n</div>\n\n<div>\n    <form  #productForm='ngForm' *ngIf='newProduct || editProduct'>\n\n            <label class=\"col-md-4\">Name</label>\n            <input class=\"form-control col-md-4\" type=\"text\" name=\"name\" [(ngModel)]='product.name'\n                #productName=\"ngModel\" minlength='3' maxlength='30' required>\n            <span *ngIf=\"productName.errors?.['required'] && productName.touched\">Missing Name !</span>\n            <span *ngIf=\"productName.errors?.['minlength'] && productName.touched\">At least 3 letters</span>\n   \n      \n            <label class=\"col-md-4\">Price</label>\n            <input class=\"form-control col-md-4\" type=\"number\" name=\"price\" [(ngModel)]='product.price'\n                #productPrice=\"ngModel\" minlength='3' maxlength='30' required>\n            <span *ngIf=\"productPrice.errors?.['required'] && productPrice.touched\">Missing price !</span>\n      \n      \n            <label class=\"col-md-4\">Category</label>\n            <select name='category' #productCategory='ngModel' [(ngModel)]='product.categoryId' class=\"custom-select\"\n                id=\"inputGroupSelect01 col-md-4\" required>\n                <option *ngFor='let c of categories' value={{c._id}} name='citiesSelect'>{{c.name}}</option>\n            </select>\n        \n            <label class=\"col-md-4\">Image</label>\n            <input class=\"form-control col-md-4\" type=\"file\" name=\"imageFile\" (input)='updateImg($event)'\n             accept=\"image/*\" multiple=\"multiple\">\n       \n        <button type=\"button\" class=\"btn btn-danger\" (click)='goBack()'>Go back</button>\n        <button class=\"btn btn-dark\" *ngIf='editProduct' type=\"button\" (click)='updateProduct()'\n        [disabled]=\"productForm.form.invalid\">Update</button>\n        <button class=\"\" *ngIf='newProduct' type=\"button\" (click)='addProduct()'\n        [disabled]=\"productForm.form.invalid\">Add</button>\n    </form>\n</div>"]},"metadata":{},"sourceType":"module"}