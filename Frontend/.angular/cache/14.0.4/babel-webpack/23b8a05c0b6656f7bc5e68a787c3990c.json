{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Natan/Desktop/Project 4/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { ProductModel } from 'src/app/models/product';\nimport { store } from 'src/app/redux/store';\nlet AdminComponent = class AdminComponent {\n  constructor(myProductsService, adminService, router) {\n    this.myProductsService = myProductsService;\n    this.adminService = adminService;\n    this.router = router;\n    this.product = new ProductModel();\n    this.categories = [];\n    this.newProduct = false;\n    this.editProduct = false;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        store.subscribe(() => {\n          _this.user = store.getState().user;\n        });\n        _this.products = yield _this.myProductsService.getAllProducts();\n        _this.categories = yield _this.adminService.getAllCategories();\n      } catch (err) {\n        alert(err.message);\n      }\n    })();\n  }\n\n  updateImg(event) {\n    this.product.img = event.target.files[0];\n  }\n\n  goToEditProduct(_id) {\n    this.editProduct = true;\n    const selectedProduct = this.products.find(p => p._id === _id);\n    this.product = selectedProduct;\n  }\n\n  goToAddProduct() {\n    this.router.navigateByUrl('/admin/add-product');\n  }\n\n  updateProduct() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        const myForm = new FormData();\n        myForm.append('image', _this2.product.img);\n        myForm.append('product', JSON.stringify(_this2.product));\n\n        _this2.adminService.updateProduct(_this2.product).then(res => {\n          const index = _this2.products.findIndex(product => product._id === res);\n\n          _this2.products[index] = res;\n          alert('product has been updated!');\n\n          _this2.goBack();\n        }, err => alert(err.message));\n      } catch (err) {\n        alert(err.message);\n      }\n    })();\n  }\n\n  goBack() {\n    this.newProduct = false;\n    this.editProduct = false;\n    this.product = new ProductModel();\n  }\n\n};\nAdminComponent = __decorate([Component({\n  selector: 'app-admin',\n  templateUrl: './admin.component.html',\n  styleUrls: ['./admin.component.css']\n})], AdminComponent);\nexport { AdminComponent };","map":{"version":3,"mappings":";;AAAA,SAASA,SAAT,QAAkC,eAAlC;AAGA,SAASC,YAAT,QAA6B,wBAA7B;AAEA,SAASC,KAAT,QAAsB,qBAAtB;AASA,IAAaC,cAAc,GAA3B,MAAaA,cAAb,CAA2B;EAQvBC,YAAoBC,iBAApB,EAAgEC,YAAhE,EAAmGC,MAAnG,EAAiH;IAA7F;IAA4C;IAAmC;IAL5F,eAAwB,IAAIN,YAAJ,EAAxB;IACA,kBAAkB,EAAlB;IACA,kBAAsB,KAAtB;IACA,mBAAuB,KAAvB;EAE+G;;EAEhHO,QAAQ;IAAA;;IAAA;MACV,IAAG;QACHN,KAAK,CAACO,SAAN,CAAgB,MAAK;UACjB,KAAI,CAACC,IAAL,GAAYR,KAAK,CAACS,QAAN,GAAiBD,IAA7B;QACH,CAFD;QAGC,KAAI,CAACE,QAAL,SAAsB,KAAI,CAACP,iBAAL,CAAuBQ,cAAvB,EAAtB;QAEA,KAAI,CAACC,UAAL,SAAwB,KAAI,CAACR,YAAL,CAAkBS,gBAAlB,EAAxB;MACJ,CAPG,CAQJ,OAAMC,GAAN,EAAe;QACXC,KAAK,CAACD,GAAG,CAACE,OAAL,CAAL;MACH;IAXa;EAYb;;EAQMC,SAAS,CAACC,KAAD,EAAW;IACvB,KAAKC,OAAL,CAAaC,GAAb,GAAmBF,KAAK,CAACG,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAnB;EACH;;EAEMC,eAAe,CAACC,GAAD,EAAY;IAC9B,KAAKC,WAAL,GAAmB,IAAnB;IACA,MAAMC,eAAe,GAAG,KAAKhB,QAAL,CAAciB,IAAd,CAAmBC,CAAC,IAAIA,CAAC,CAACJ,GAAF,KAAUA,GAAlC,CAAxB;IACA,KAAKL,OAAL,GAAeO,eAAf;EACH;;EAEMG,cAAc;IACjB,KAAKxB,MAAL,CAAYyB,aAAZ,CAA0B,oBAA1B;EACH;;EAGYC,aAAa;IAAA;;IAAA;MACtB,IAAG;QACC,MAAMC,MAAM,GAAa,IAAIC,QAAJ,EAAzB;QACAD,MAAM,CAACE,MAAP,CAAc,OAAd,EAAuB,MAAI,CAACf,OAAL,CAAaC,GAApC;QACAY,MAAM,CAACE,MAAP,CAAc,SAAd,EAAyBC,IAAI,CAACC,SAAL,CAAe,MAAI,CAACjB,OAApB,CAAzB;;QACA,MAAI,CAACf,YAAL,CAAkB2B,aAAlB,CAAgC,MAAI,CAACZ,OAArC,EAA8CkB,IAA9C,CAAmDC,GAAG,IAAG;UACrD,MAAMC,KAAK,GAAG,MAAI,CAAC7B,QAAL,CAAc8B,SAAd,CAAwBrB,OAAO,IAAIA,OAAO,CAACK,GAAR,KAAgBc,GAAnD,CAAd;;UACA,MAAI,CAAC5B,QAAL,CAAc6B,KAAd,IAAuBD,GAAvB;UACAvB,KAAK,CAAC,2BAAD,CAAL;;UACA,MAAI,CAAC0B,MAAL;QACH,CALD,EAKG3B,GAAG,IAAIC,KAAK,CAACD,GAAG,CAACE,OAAL,CALf;MAMH,CAVD,CAWA,OAAMF,GAAN,EAAc;QACVC,KAAK,CAACD,GAAG,CAACE,OAAL,CAAL;MACH;IAdqB;EAezB;;EAGMyB,MAAM;IACT,KAAKC,UAAL,GAAkB,KAAlB;IACA,KAAKjB,WAAL,GAAmB,KAAnB;IACA,KAAKN,OAAL,GAAe,IAAIpB,YAAJ,EAAf;EACH;;AAnEsB,CAA3B;AAAaE,cAAc,eAL1BH,SAAS,CAAC;EACP6C,QAAQ,EAAE,WADH;EAEPC,WAAW,EAAE,wBAFN;EAGPC,SAAS,EAAE,CAAC,uBAAD;AAHJ,CAAD,CAKiB,GAAd5C,cAAc,CAAd;SAAAA","names":["Component","ProductModel","store","AdminComponent","constructor","myProductsService","adminService","router","ngOnInit","subscribe","user","getState","products","getAllProducts","categories","getAllCategories","err","alert","message","updateImg","event","product","img","target","files","goToEditProduct","_id","editProduct","selectedProduct","find","p","goToAddProduct","navigateByUrl","updateProduct","myForm","FormData","append","JSON","stringify","then","res","index","findIndex","goBack","newProduct","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\Natan\\Desktop\\Project 4\\Frontend\\src\\app\\components\\admin-area\\admin\\admin.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { UserModel } from 'src/app/models/user';\nimport { ProductsService } from 'src/app/services/products.service';\nimport { ProductModel } from 'src/app/models/product';\nimport { AdminService } from 'src/app/services/admin.service';\nimport { store } from 'src/app/redux/store';\nimport { Router } from '@angular/router';\n\n\n@Component({\n    selector: 'app-admin',\n    templateUrl: './admin.component.html',\n    styleUrls: ['./admin.component.css']\n})\nexport class AdminComponent implements OnInit {\n    public user: UserModel;\n    public products: ProductModel[];\n    public product: ProductModel = new ProductModel();\n    public categories: any = [];\n    public newProduct: boolean = false;\n    public editProduct: boolean = false;\n\n    constructor(private myProductsService: ProductsService, private adminService: AdminService,private router: Router) { }\n\n    async ngOnInit() {\n        try{ \n        store.subscribe(() => {\n            this.user = store.getState().user;\n        });\n         this.products = await this.myProductsService.getAllProducts()\n\n         this.categories = await this.adminService.getAllCategories()    \n    }\n    catch(err: any){\n        alert(err.message);\n    }\n    }\n\n\n   \n\n\n\n\n    public updateImg(event: any): void {\n        this.product.img = event.target.files[0];\n    }\n\n    public goToEditProduct(_id: string): void {\n        this.editProduct = true;\n        const selectedProduct = this.products.find(p => p._id === _id);\n        this.product = selectedProduct;\n    }\n\n    public goToAddProduct(): void {\n        this.router.navigateByUrl('/admin/add-product');\n    }\n\n\n    public async updateProduct(){\n        try{\n            const myForm: FormData = new FormData();\n            myForm.append('image', this.product.img);\n            myForm.append('product', JSON.stringify(this.product));\n            this.adminService.updateProduct(this.product).then(res => {\n                const index = this.products.findIndex(product => product._id === res);\n                this.products[index] = res;\n                alert('product has been updated!');\n                this.goBack();\n            }, err => alert(err.message))\n        }\n        catch(err:any){\n            alert(err.message);\n        }\n    }\n    \n\n    public goBack(): void {\n        this.newProduct = false;\n        this.editProduct = false;\n        this.product = new ProductModel();\n    }\n}\n"]},"metadata":{},"sourceType":"module"}