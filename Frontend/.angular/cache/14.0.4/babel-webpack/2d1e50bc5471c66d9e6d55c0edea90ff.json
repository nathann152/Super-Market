{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Natan/Desktop/Project 4/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { store } from 'src/app/redux/store';\nimport { OrderModel } from 'src/app/models/order';\nimport { ActionType } from 'src/app/redux/action-type';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/shopping-cart.service\";\nimport * as i2 from \"src/app/services/order.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/datepicker\";\nimport * as i7 from \"@angular/material/form-field\";\n\nfunction PaymentPageComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function PaymentPageComponent_div_0_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.routeToHome());\n    });\n    i0.ɵɵtext(2, \"Back to shopping\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction PaymentPageComponent_div_1_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"p\", 30);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"currency\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const p_r21 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"id\", p_r21.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(p_r21.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r21.amount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 4, p_r21.price));\n  }\n}\n\nfunction PaymentPageComponent_div_1_option_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const c_r22 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", c_r22);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(c_r22);\n  }\n}\n\nfunction PaymentPageComponent_div_1_mat_error_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Missing Street !\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PaymentPageComponent_div_1_mat_error_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"At least 3 letters\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PaymentPageComponent_div_1_mat_error_50_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Missing date ! \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PaymentPageComponent_div_1_mat_error_51_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Invalid date \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PaymentPageComponent_div_1_mat_error_60_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"Missing credit card ! \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PaymentPageComponent_div_1_mat_error_61_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \"You need at least 16 characters\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PaymentPageComponent_div_1_mat_error_62_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Invalid credit card number(regex for visa master card)\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PaymentPageComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"div\", 7)(3, \"input\", 8, 9);\n    i0.ɵɵlistener(\"input\", function PaymentPageComponent_div_1_Template_input_input_3_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.searchProduct());\n    })(\"ngModelChange\", function PaymentPageComponent_div_1_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.searchStr = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"table\")(6, \"thead\")(7, \"tr\")(8, \"th\");\n    i0.ɵɵtext(9, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"price\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(14, \"tbody\");\n    i0.ɵɵtemplate(15, PaymentPageComponent_div_1_tr_15_Template, 9, 6, \"tr\", 10);\n    i0.ɵɵelementStart(16, \"tr\")(17, \"td\", 11);\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"currency\");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(20, \"div\", 12)(21, \"form\", null, 13)(23, \"h3\");\n    i0.ɵɵtext(24, \"Shipping Details :\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(25, \"hr\");\n    i0.ɵɵelementStart(26, \"div\", 14)(27, \"label\", 15);\n    i0.ɵɵtext(28, \"City\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"select\", 16, 17);\n    i0.ɵɵlistener(\"ngModelChange\", function PaymentPageComponent_div_1_Template_select_ngModelChange_29_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r26.order.city = $event);\n    });\n    i0.ɵɵtemplate(31, PaymentPageComponent_div_1_option_31_Template, 2, 2, \"option\", 18);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(32, \"div\", 14)(33, \"label\", 15);\n    i0.ɵɵtext(34, \"Street\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(35, \"input\", 19, 20);\n    i0.ɵɵlistener(\"ngModelChange\", function PaymentPageComponent_div_1_Template_input_ngModelChange_35_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.order.street = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(37, PaymentPageComponent_div_1_mat_error_37_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵtemplate(38, PaymentPageComponent_div_1_mat_error_38_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(39, \"div\", 14)(40, \"label\", 15);\n    i0.ɵɵtext(41, \"Shipping Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(42, \"mat-form-field\", 15)(43, \"mat-label\");\n    i0.ɵɵtext(44, \"Choose a date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(45, \"input\", 22, 23);\n    i0.ɵɵlistener(\"ngModelChange\", function PaymentPageComponent_div_1_Template_input_ngModelChange_45_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n\n      const _r7 = i0.ɵɵreference(22);\n\n      const ctx_r28 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r28.dateValidator(_r7, $event));\n    })(\"ngModelChange\", function PaymentPageComponent_div_1_Template_input_ngModelChange_45_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r29 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r29.order.shippingDate = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(47, \"mat-datepicker-toggle\", 24)(48, \"mat-datepicker\", 25, 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(50, PaymentPageComponent_div_1_mat_error_50_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵtemplate(51, PaymentPageComponent_div_1_mat_error_51_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(52, \"h3\");\n    i0.ɵɵtext(53, \"Payments :\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(54, \"hr\");\n    i0.ɵɵelementStart(55, \"div\", 14)(56, \"label\", 15);\n    i0.ɵɵtext(57, \"Credit card\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(58, \"input\", 27, 28);\n    i0.ɵɵlistener(\"ngModelChange\", function PaymentPageComponent_div_1_Template_input_ngModelChange_58_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.order.creditCard = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(60, PaymentPageComponent_div_1_mat_error_60_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵtemplate(61, PaymentPageComponent_div_1_mat_error_61_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵtemplate(62, PaymentPageComponent_div_1_mat_error_62_Template, 2, 0, \"mat-error\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(63, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function PaymentPageComponent_div_1_Template_button_click_63_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r31 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r31.sendOrder());\n    });\n    i0.ɵɵtext(64, \"Order\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const _r7 = i0.ɵɵreference(22);\n\n    const _r10 = i0.ɵɵreference(36);\n\n    const _r13 = i0.ɵɵreference(46);\n\n    const _r14 = i0.ɵɵreference(49);\n\n    const _r17 = i0.ɵɵreference(59);\n\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.searchStr);\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.products);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Total Price : \", i0.ɵɵpipeBind1(19, 19, ctx_r1.order.totalPrice), \"\");\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.order.city);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.cities);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.order.street);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (_r10.errors == null ? null : _r10.errors[\"required\"]) && _r10.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (_r10.errors == null ? null : _r10.errors[\"minlength\"]) && _r10.touched);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"matDatepicker\", _r14)(\"ngModel\", ctx_r1.order.shippingDate);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"for\", _r14);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"dateClass\", ctx_r1.dateClass());\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (_r13.errors == null ? null : _r13.errors[\"required\"]) && _r13.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (_r13.errors == null ? null : _r13.errors[\"invalid_Date\"]) && _r13.touched);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.order.creditCard);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (_r17.errors == null ? null : _r17.errors[\"required\"]) && _r17.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (_r17.errors == null ? null : _r17.errors[\"minlength\"]) && _r17.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (_r17.errors == null ? null : _r17.errors[\"pattern\"]) && _r17.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", _r7.form.invalid);\n  }\n}\n\nfunction PaymentPageComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r33 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 32)(1, \"h3\");\n    i0.ɵɵtext(2, \"Your purchase was successful !\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"a\", 33);\n    i0.ɵɵtext(4, \"To download the receipt, click here\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\")(6, \"br\");\n    i0.ɵɵelementStart(7, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function PaymentPageComponent_div_2_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r33);\n      const ctx_r32 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r32.routeToHome());\n    });\n    i0.ɵɵtext(8, \"Back to homepage\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"href\", ctx_r2.path + ctx_r2.filePath, i0.ɵɵsanitizeUrl);\n  }\n}\n\nexport class PaymentPageComponent {\n  constructor(myShoppingService, myOrderServices, myRouter) {\n    this.myShoppingService = myShoppingService;\n    this.myOrderServices = myOrderServices;\n    this.myRouter = myRouter;\n    this.user = store.getState().user;\n    this.order = new OrderModel();\n    this.cities = [\"Tel-Aviv\", \"Haifa\", \"Ashdod\", \"Beer-Sheva\", \"Afula\", \"Bat-Yam\", \"Eilat\", \"Hadera\", \"Herzliya\", \"Jerusalem\"];\n    this.datesArr = [];\n    this.paymentComplete = false;\n    this.filePath = '';\n    this.path = 'http://localhost:3010/api/order/get-receipt';\n  }\n\n  ngOnInit() {\n    store.subscribe(() => {\n      this.user = store.getState().user;\n    }); //get all products and total price..\n\n    const localCart = localStorage.getItem(\"myCart\");\n\n    const cartId = JSON.parse(localCart)._id;\n\n    this.myShoppingService.getAllProducts({\n      cartId: cartId\n    }).subscribe(res => {\n      this.products = res;\n      this.order.totalPrice = this.myShoppingService.getTotalPrice(res);\n    }, err => alert(err.message));\n    this.order.cartId = cartId; //get all orders for date picker\n\n    this.getAllOrders();\n    setTimeout(() => {\n      this.order.city = this.user.city;\n      this.order.street = this.user.street;\n    }, 1000);\n  }\n\n  searchProduct() {\n    //reset all marked products \n    this.products.map(p => document.getElementById(p.name).removeAttribute(\"class\"));\n\n    if (this.searchStr.length === 0) {\n      return;\n    } //create tmp arr for marked products\n\n\n    let tmpArr = [];\n    this.products.map(p => {\n      if (p.name.includes(this.searchStr)) {\n        tmpArr.push(p);\n        document.getElementById(p.name).setAttribute(\"class\", \"marked\");\n      }\n    });\n  }\n\n  routeToHome() {\n    this.myRouter.navigateByUrl(\"/\");\n  }\n\n  sendOrder() {\n    if (this.order.shippingDate === undefined) {\n      alert('Enter date !');\n      return;\n    }\n\n    this.myOrderServices.addOrder(this.order).subscribe(res => {\n      this.filePath = res.file;\n      this.paymentComplete = true;\n    }, err => alert(err.message));\n    localStorage.removeItem(\"myCart\");\n    const action = {\n      type: ActionType.getAllProductsOfCart\n    };\n    store.dispatch(action);\n  }\n\n  dateValidator(myForm, date) {\n    const todayDate = new Date().getTime();\n    const inputDate = date.getTime(); // if selected date is smaller than today's date\n\n    if (todayDate > inputDate) {\n      if (date.toDateString() === new Date().toDateString()) {\n        //if this today day don't throw error\n        myForm.controls['datepicker'].setErrors({\n          'invalid_Date': null\n        });\n        return;\n      }\n\n      myForm.controls['datepicker'].setErrors({\n        'invalid_Date': true\n      });\n      myForm.form.setErrors({\n        invalid: true\n      });\n      return;\n    } else {\n      myForm.controls['datepicker'].setErrors({\n        'invalid_Date': null\n      });\n    }\n  }\n\n  getAllOrders() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const tmpArrCount = []; //get all orders dates \n\n      _this.myOrderServices.getAllOrder().subscribe(res => {\n        res.map(order => {\n          //arrange them by count \n          const date = new Date(order.shippingDate).toLocaleDateString();\n          let obj = tmpArrCount.find(e => e.date === date);\n\n          if (obj) {\n            obj.count++;\n            return;\n          }\n\n          tmpArrCount.push({\n            date: date,\n            count: 1\n          });\n        });\n      }, err => alert(err.message));\n\n      setTimeout(() => {\n        tmpArrCount.map(obj => obj.count >= 3 ? _this.datesArr.push(obj.date) : null);\n      }, 1000);\n    })();\n  }\n\n  dateClass() {\n    return date => {\n      const newDate = date.toLocaleDateString();\n      return this.datesArr.map(date => newDate === date ? 'busy-day' : '');\n    };\n  }\n\n}\n\nPaymentPageComponent.ɵfac = function PaymentPageComponent_Factory(t) {\n  return new (t || PaymentPageComponent)(i0.ɵɵdirectiveInject(i1.ShoppingCartService), i0.ɵɵdirectiveInject(i2.OrderService), i0.ɵɵdirectiveInject(i3.Router));\n};\n\nPaymentPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PaymentPageComponent,\n  selectors: [[\"app-payment-page\"]],\n  decls: 3,\n  vars: 3,\n  consts: [[\"class\", \"col-md-12\", 4, \"ngIf\"], [\"class\", \"payment-page row col-md-12 container\", 4, \"ngIf\"], [\"class\", \"finalDiv\", 4, \"ngIf\"], [1, \"col-md-12\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 2, \"margin\", \"5px\", 3, \"click\"], [1, \"payment-page\", \"row\", \"col-md-12\", \"container\"], [1, \"receipt\", \"col-md-6\"], [1, \"input-group\", \"mb-3\"], [\"type\", \"text\", \"placeholder\", \"Search\", \"aria-label\", \"Search\", \"aria-describedby\", \"button-addon2\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"input\", \"ngModelChange\"], [\"searchProductInput\", \"ngModel\"], [4, \"ngFor\", \"ngForOf\"], [\"colspan\", \"3\", \"id\", \"total-price-td\"], [1, \"payment-div\", \"col-md-6\"], [\"paymentForm\", \"ngForm\"], [1, \"form-group\", \"col-md-12\", \"row\"], [1, \"col-md-6\"], [\"name\", \"citiesSelect\", \"id\", \"inputGroupSelect01 col-md-6\", \"required\", \"\", 1, \"custom-select\", 3, \"ngModel\", \"ngModelChange\"], [\"selectedCity\", \"ngModel\"], [\"name\", \"citiesSelect\", 3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"text\", \"name\", \"street\", \"minlength\", \"3\", \"maxlength\", \"30\", \"required\", \"\", 1, \"form-control\", \"col-md-6\", 3, \"ngModel\", \"ngModelChange\"], [\"streetInfo\", \"ngModel\"], [4, \"ngIf\"], [\"matInput\", \"\", \"name\", \"datepicker\", \"disabled\", \"\", \"required\", \"\", 3, \"matDatepicker\", \"ngModel\", \"ngModelChange\"], [\"datepickerInput\", \"ngModel\"], [\"matSuffix\", \"\", 3, \"for\"], [\"disabled\", \"false\", 3, \"dateClass\"], [\"picker\", \"\"], [\"type\", \"text\", \"name\", \"creditCard\", \"required\", \"\", \"maxlength\", \"16\", \"pattern\", \"^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14})$\", 1, \"form-control\", \"col-md-6\", 3, \"ngModel\", \"ngModelChange\"], [\"creditCardInput\", \"ngModel\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"], [3, \"id\"], [\"name\", \"citiesSelect\", 3, \"value\"], [1, \"finalDiv\"], [\"download\", \"receipt.txt\", \"target\", \"_blank\", 3, \"href\"]],\n  template: function PaymentPageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, PaymentPageComponent_div_0_Template, 3, 0, \"div\", 0);\n      i0.ɵɵtemplate(1, PaymentPageComponent_div_1_Template, 65, 21, \"div\", 1);\n      i0.ɵɵtemplate(2, PaymentPageComponent_div_2_Template, 9, 1, \"div\", 2);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.user && !ctx.paymentComplete);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.user && !ctx.paymentComplete);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.paymentComplete);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.MinLengthValidator, i5.MaxLengthValidator, i5.PatternValidator, i5.NgModel, i5.NgForm, i6.MatDatepicker, i6.MatDatepickerInput, i6.MatDatepickerToggle, i7.MatError, i7.MatFormField, i7.MatLabel, i7.MatSuffix, i4.CurrencyPipe],\n  styles: [\"div[_ngcontent-%COMP%] {\\n    text-align: center;\\n}\\n\\n.payment-div[_ngcontent-%COMP%] {\\n    margin-top: 10px;\\n}\\n\\ntable[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%] {\\n    border: 1px solid #ddd;\\n    text-align: center;\\n}\\n\\ntable[_ngcontent-%COMP%] {\\n    border-collapse: collapse;\\n    width: 100%;\\n    margin-top: 10px;\\n}\\n\\nth[_ngcontent-%COMP%], td[_ngcontent-%COMP%] {\\n    padding: 15px;\\n}\\n\\nth[_ngcontent-%COMP%] {\\n    background: #2D2D2A;\\n    color: whitesmoke;\\n    font-weight: 500;\\n}\\n\\n#total-price-td[_ngcontent-%COMP%] {\\n    background-color: #101935;\\n    color: whitesmoke;\\n    font-weight: 500;\\n}\\n\\ninput[_ngcontent-%COMP%], select[_ngcontent-%COMP%] {\\n    width: 300px;\\n}\\n\\nlabel[_ngcontent-%COMP%] {\\n    text-align: end;\\n    margin-top: 5px;\\n    font-weight: 500;\\n}\\n\\nhr[_ngcontent-%COMP%] {\\n    width: 300px;\\n}\\n\\nmat-error[_ngcontent-%COMP%] {\\n    margin-left: 60%;\\n}\\n\\n.marked[_ngcontent-%COMP%] {\\n    background-color: yellow;\\n}\\n\\n  svg.mat-datepicker-toggle-default-icon.ng-star-inserted {\\n    font-size: 50px;\\n}\\n\\n  .mat-form-field-wrapper.ng-tns-c66-0 {\\n    width: 150px;\\n}\\n\\n  .busy-day {\\n    background: red;\\n    border-radius: 100%;\\n    pointer-events: none;\\n}\\n\\n\\n\\nform[_ngcontent-%COMP%] {\\n    width: 400px;\\n    height: 600px;\\n    text-align: left;\\n    padding: 10px;\\n    border: 1px solid black;\\n    margin: auto;\\n}\\n\\n.date_shipping[_ngcontent-%COMP%]{\\n    width: 270px;\\n    height: 50px;\\n    margin-top: 10px;\\n    margin-bottom: 10px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBheW1lbnQtcGFnZS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksa0JBQWtCO0FBQ3RCOztBQUVBO0lBQ0ksZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksc0JBQXNCO0lBQ3RCLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLHlCQUF5QjtJQUN6QixXQUFXO0lBQ1gsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksYUFBYTtBQUNqQjs7QUFFQTtJQUNJLG1CQUFtQjtJQUNuQixpQkFBaUI7SUFDakIsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0kseUJBQXlCO0lBQ3pCLGlCQUFpQjtJQUNqQixnQkFBZ0I7QUFDcEI7O0FBRUE7SUFDSSxZQUFZO0FBQ2hCOztBQUVBO0lBQ0ksZUFBZTtJQUNmLGVBQWU7SUFDZixnQkFBZ0I7QUFDcEI7O0FBRUE7SUFDSSxZQUFZO0FBQ2hCOztBQUVBO0lBQ0ksZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksd0JBQXdCO0FBQzVCOztBQUVBO0lBQ0ksZUFBZTtBQUNuQjs7QUFFQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxlQUFlO0lBQ2YsbUJBQW1CO0lBQ25CLG9CQUFvQjtBQUN4Qjs7QUFFQTs7OztHQUlHOztBQUNIO0lBQ0ksWUFBWTtJQUNaLGFBQWE7SUFDYixnQkFBZ0I7SUFDaEIsYUFBYTtJQUNiLHVCQUF1QjtJQUN2QixZQUFZO0FBQ2hCOztBQUNBO0lBQ0ksWUFBWTtJQUNaLFlBQVk7SUFDWixnQkFBZ0I7SUFDaEIsbUJBQW1CO0FBQ3ZCIiwiZmlsZSI6InBheW1lbnQtcGFnZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiZGl2IHtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5cbi5wYXltZW50LWRpdiB7XG4gICAgbWFyZ2luLXRvcDogMTBweDtcbn1cblxudGFibGUsIHRkLCB0aCB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgI2RkZDtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5cbnRhYmxlIHtcbiAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIG1hcmdpbi10b3A6IDEwcHg7XG59XG5cbnRoLCB0ZCB7XG4gICAgcGFkZGluZzogMTVweDtcbn1cblxudGgge1xuICAgIGJhY2tncm91bmQ6ICMyRDJEMkE7XG4gICAgY29sb3I6IHdoaXRlc21va2U7XG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcbn1cblxuI3RvdGFsLXByaWNlLXRkIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTAxOTM1O1xuICAgIGNvbG9yOiB3aGl0ZXNtb2tlO1xuICAgIGZvbnQtd2VpZ2h0OiA1MDA7XG59XG5cbmlucHV0LCBzZWxlY3Qge1xuICAgIHdpZHRoOiAzMDBweDtcbn1cblxubGFiZWwge1xuICAgIHRleHQtYWxpZ246IGVuZDtcbiAgICBtYXJnaW4tdG9wOiA1cHg7XG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcbn1cblxuaHIge1xuICAgIHdpZHRoOiAzMDBweDtcbn1cblxubWF0LWVycm9yIHtcbiAgICBtYXJnaW4tbGVmdDogNjAlO1xufVxuXG4ubWFya2VkIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7XG59XG5cbjo6bmctZGVlcCBzdmcubWF0LWRhdGVwaWNrZXItdG9nZ2xlLWRlZmF1bHQtaWNvbi5uZy1zdGFyLWluc2VydGVkIHtcbiAgICBmb250LXNpemU6IDUwcHg7XG59XG5cbjo6bmctZGVlcCAubWF0LWZvcm0tZmllbGQtd3JhcHBlci5uZy10bnMtYzY2LTAge1xuICAgIHdpZHRoOiAxNTBweDtcbn1cblxuOjpuZy1kZWVwIC5idXN5LWRheSB7XG4gICAgYmFja2dyb3VuZDogcmVkO1xuICAgIGJvcmRlci1yYWRpdXM6IDEwMCU7XG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG59XG5cbi8qIC5maW5hbERpdiB7XG4gICAgYmFja2dyb3VuZDogI2UwZGRkZDtcbiAgICBwYWRkaW5nOiAxMDBweDtcbiAgICBtYXJnaW46IDMwcHg7XG59ICovXG5mb3JtIHtcbiAgICB3aWR0aDogNDAwcHg7XG4gICAgaGVpZ2h0OiA2MDBweDtcbiAgICB0ZXh0LWFsaWduOiBsZWZ0O1xuICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7XG4gICAgbWFyZ2luOiBhdXRvO1xufVxuLmRhdGVfc2hpcHBpbmd7XG4gICAgd2lkdGg6IDI3MHB4O1xuICAgIGhlaWdodDogNTBweDtcbiAgICBtYXJnaW4tdG9wOiAxMHB4O1xuICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XG59XG4iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["store","OrderModel","ActionType","i0","ctx_r1","PaymentPageComponent","constructor","myShoppingService","myOrderServices","myRouter","getState","user","ngOnInit","subscribe","localCart","localStorage","getItem","cartId","JSON","parse","_id","getAllProducts","res","products","order","totalPrice","getTotalPrice","err","alert","message","getAllOrders","setTimeout","city","street","searchProduct","map","p","document","getElementById","name","removeAttribute","searchStr","length","tmpArr","includes","push","setAttribute","routeToHome","navigateByUrl","sendOrder","shippingDate","undefined","addOrder","filePath","file","paymentComplete","removeItem","action","type","getAllProductsOfCart","dispatch","dateValidator","myForm","date","todayDate","Date","getTime","inputDate","toDateString","controls","setErrors","form","invalid","tmpArrCount","getAllOrder","toLocaleDateString","obj","find","e","count","datesArr","dateClass","newDate","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Natan\\Desktop\\Project 4\\Frontend\\src\\app\\components\\payment-page\\payment-page.component.ts","C:\\Users\\Natan\\Desktop\\Project 4\\Frontend\\src\\app\\components\\payment-page\\payment-page.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { CartDetail } from 'src/app/models/cart-detail';\nimport { UserModel } from 'src/app/models/user';\nimport { store } from 'src/app/redux/store';\nimport { ShoppingCartService } from 'src/app/services/shopping-cart.service';\nimport { OrderModel } from 'src/app/models/order';\nimport { Router } from '@angular/router';\nimport { NgForm } from '@angular/forms';\nimport { MatCalendarCellCssClasses } from '@angular/material/datepicker';\nimport { OrderService } from 'src/app/services/order.service';\nimport { ActionType } from 'src/app/redux/action-type';\n\n@Component({\n  selector: 'app-payment-page',\n  templateUrl: './payment-page.component.html',\n  styleUrls: ['./payment-page.component.css']\n})\n\nexport class PaymentPageComponent implements OnInit {\n  public products: CartDetail[];\n  public user: UserModel = store.getState().user;\n  public totalPrice: number;\n  public order: OrderModel = new OrderModel();\n  public cities = [\"Tel-Aviv\", \"Haifa\", \"Ashdod\", \"Beer-Sheva\", \"Afula\",\n    \"Bat-Yam\", \"Eilat\", \"Hadera\", \"Herzliya\", \"Jerusalem\"];\n  public searchStr: string;\n  public datesArr: any[] = [];\n  public paymentComplete: boolean = false;\n  public filePath: string = '';\n  public path: string = 'http://localhost:3010/api/order/get-receipt';\n\n\n  constructor(private myShoppingService: ShoppingCartService, private myOrderServices: OrderService,\n    private myRouter: Router) { }\n\n  ngOnInit(): void {\n    store.subscribe(() => {\n      this.user = store.getState().user;\n    });\n    //get all products and total price..\n    const localCart = localStorage.getItem(\"myCart\");\n    const cartId = JSON.parse(localCart)._id;\n    this.myShoppingService.getAllProducts({ cartId: cartId })\n      .subscribe(res => {\n        this.products = res;\n        this.order.totalPrice = this.myShoppingService.getTotalPrice(res);\n      }, err => alert(err.message));\n\n    this.order.cartId = cartId;\n    //get all orders for date picker\n    this.getAllOrders();\n    setTimeout(() => {\n      this.order.city = this.user.city;\n      this.order.street = this.user.street;\n    }, 1000);\n  }\n\n  public searchProduct(): void {\n    //reset all marked products \n    this.products.map(p => document.getElementById(p.name).removeAttribute(\"class\"));\n    if (this.searchStr.length === 0) { return; }\n    //create tmp arr for marked products\n    let tmpArr = [];\n    this.products.map(p => {\n      if (p.name.includes(this.searchStr)) {\n        tmpArr.push(p);\n        document.getElementById(p.name).setAttribute(\"class\", \"marked\");\n      }\n    });\n  }\n\n  public routeToHome(): void { this.myRouter.navigateByUrl(\"/\"); }\n\n  public sendOrder(): void {\n    if (this.order.shippingDate === undefined) { alert('Enter date !'); return; }\n    this.myOrderServices.addOrder(this.order)\n      .subscribe(res => { this.filePath = res.file; this.paymentComplete = true; }, err => alert(err.message));\n      localStorage.removeItem(\"myCart\");\n      const action = { type: ActionType.getAllProductsOfCart};\n        store.dispatch(action);\n  }\n\n  public dateValidator(myForm: NgForm, date: Date): void {\n    const todayDate = new Date().getTime();\n    const inputDate = date.getTime();\n    // if selected date is smaller than today's date\n    if (todayDate > inputDate) {\n      if (date.toDateString() === new Date().toDateString()) {\n        //if this today day don't throw error\n        myForm.controls['datepicker'].setErrors({ 'invalid_Date': null });\n        return;\n      }\n      myForm.controls['datepicker'].setErrors({ 'invalid_Date': true });\n      myForm.form.setErrors({invalid: true})\n      return;\n    } else { myForm.controls['datepicker'].setErrors({ 'invalid_Date': null }); }\n  }\n  public async getAllOrders(): void {\n    const tmpArrCount = [];\n    //get all orders dates \n    this.myOrderServices.getAllOrder()\n      .subscribe(res => {\n        res.map(order => {\n          //arrange them by count \n          const date = new Date(order.shippingDate).toLocaleDateString();\n          let obj = tmpArrCount.find(e => e.date === date);\n          if (obj) { obj.count++; return; }\n          tmpArrCount.push({ date: date, count: 1 })\n        });\n      }, err => alert(err.message));\n    setTimeout(() => {\n      tmpArrCount.map(obj => obj.count >= 3 ? this.datesArr.push(obj.date) : null);\n    }, 1000);\n  }\n  public dateClass() {\n    return (date: Date): MatCalendarCellCssClasses => {\n      const newDate = date.toLocaleDateString();\n      return this.datesArr.map(date => (newDate === date) ? 'busy-day' : '')\n    };\n  }\n\n}\n","<div class=\"col-md-12\" *ngIf='user && !paymentComplete'>\n    <button type=\"button\" class=\"btn btn-success\" style=\"margin: 5px;\" (click)='routeToHome()'>Back to shopping</button>\n</div>\n<div class=\"payment-page row col-md-12 container\" *ngIf='user && !paymentComplete'>\n    <div class=\"receipt col-md-6\">\n        <div class=\"input-group mb-3\">\n            <input type=\"text\" class=\"form-control\" placeholder=\"Search\" aria-label=\"Search\" (input)=\"searchProduct()\"\n                aria-describedby=\"button-addon2\" required #searchProductInput='ngModel' [(ngModel)]='searchStr'>\n        </div>\n        <table>\n            <thead>\n                <tr>\n                    <th>Name</th>\n                    <th>amount</th>\n                    <th>price</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr *ngFor='let p of products'>\n                    <td>\n                        <p id={{p.name}}>{{p.name}}</p>\n                    </td>\n                    <td>{{p.amount}}</td>\n                    <td>{{p.price|currency}}</td>\n                </tr>\n                <tr>\n                    <td colspan=\"3\" id=\"total-price-td\">Total Price : {{this.order.totalPrice|currency}}</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    <div class=\"payment-div col-md-6\">\n        <form #paymentForm='ngForm'>\n            <h3>Shipping Details :</h3>\n            <hr>\n            <div class=\"form-group col-md-12 row\">\n                <label class=\"col-md-6\">City</label>\n                <select name='citiesSelect' #selectedCity='ngModel' [(ngModel)]='order.city' class=\"custom-select\"\n                    id=\"inputGroupSelect01 col-md-6\" required>\n                    <option *ngFor='let c of cities' value={{c}} name='citiesSelect'>{{c}}</option>\n                </select>\n            </div>\n            <div class=\"form-group col-md-12 row\">\n                <label class=\"col-md-6\">Street</label>\n                <input class=\"form-control col-md-6\" type=\"text\" name=\"street\" [(ngModel)]='order.street'\n                    #streetInfo=\"ngModel\" minlength='3' maxlength='30' required>\n                <mat-error *ngIf=\"streetInfo.errors?.['required'] && streetInfo.touched\">Missing Street !</mat-error>\n                <mat-error *ngIf=\"streetInfo.errors?.['minlength'] && streetInfo.touched\">At least 3 letters</mat-error>\n            </div>\n            <div class=\"form-group col-md-12 row\">\n                <label class=\"col-md-6\">Shipping Date</label>\n                <mat-form-field class=\"col-md-6\">\n                    <mat-label>Choose a date</mat-label>\n                    <input matInput [matDatepicker]=\"picker\" (ngModelChange)='dateValidator(paymentForm,$event)'\n                        [(ngModel)]='order.shippingDate' #datepickerInput='ngModel' name=\"datepicker\" disabled required>\n                    <mat-datepicker-toggle matSuffix [for]=\"picker\"></mat-datepicker-toggle>\n                    <mat-datepicker disabled=\"false\" [dateClass]=\"dateClass()\" #picker></mat-datepicker>\n                </mat-form-field>\n                <mat-error *ngIf=\"datepickerInput.errors?.['required'] && datepickerInput.touched\">Missing date !\n                </mat-error>\n                <mat-error *ngIf=\"datepickerInput.errors?.['invalid_Date'] && datepickerInput.touched\">Invalid date\n                </mat-error>\n            </div>\n            <h3>Payments :</h3>\n            <hr>\n            <div class=\"form-group col-md-12 row\">\n                <label class=\"col-md-6\">Credit card</label>\n                <input type=\"text\" class=\"form-control col-md-6\" name=\"creditCard\" required maxlength='16'\n                    #creditCardInput='ngModel' [(ngModel)]='order.creditCard'\n                    pattern='^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14})$'>\n                <mat-error *ngIf=\"creditCardInput.errors?.['required'] && creditCardInput.touched\">Missing credit card !\n                </mat-error>\n                <mat-error *ngIf=\"creditCardInput.errors?.['minlength'] && creditCardInput.touched\">You need at least 16\n                    characters</mat-error>\n                <mat-error *ngIf=\"creditCardInput.errors?.['pattern']&& creditCardInput.touched\">\n                    Invalid credit card number(regex for visa master card)</mat-error>\n            </div>\n            <button type=\"button\" class=\"btn btn-primary\"\n                [disabled]=\"paymentForm.form.invalid \"\n                (click)='sendOrder()'>Order</button>\n        </form>\n    </div>\n</div>\n\n<div class=\"finalDiv\" *ngIf='paymentComplete'>\n    <h3>Your purchase was successful !</h3>\n    <a [href]='path + filePath' download=\"receipt.txt\" target=\"_blank\">To download the receipt, click here</a>\n    <br><br>\n    <button type=\"button\" class=\"btn btn-success\" style=\"margin: 5px;\" (click)='routeToHome()'>Back to homepage</button>\n</div>"]},"metadata":{},"sourceType":"module"}