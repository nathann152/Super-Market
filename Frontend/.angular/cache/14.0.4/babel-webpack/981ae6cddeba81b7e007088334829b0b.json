{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Natan/Desktop/Project 4/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { store } from 'src/app/redux/store';\nimport { ActionType } from 'src/app/redux/action-type';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/shopping-cart.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/router\";\n\nfunction ShoppingCartComponent_div_0_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.shoppingCartProducts.length);\n  }\n}\n\nfunction ShoppingCartComponent_div_0_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Please Login / Register .\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ShoppingCartComponent_div_0_p_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Your shopping cart is empty\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ShoppingCartComponent_div_0_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵelementStart(2, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ShoppingCartComponent_div_0_div_9_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.continueShopping());\n    });\n    i0.ɵɵtext(3, \"Continue shopping with the previous cart\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\")(5, \"br\");\n    i0.ɵɵelementStart(6, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ShoppingCartComponent_div_0_div_9_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.clearCart());\n    });\n    i0.ɵɵtext(7, \"New cart\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction ShoppingCartComponent_div_0_div_10_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵelement(1, \"img\", 16);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\", 17);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"span\", 18);\n    i0.ɵɵlistener(\"click\", function ShoppingCartComponent_div_0_div_10_button_1_Template_span_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const p_r12 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r13.removeProductFromCart(p_r12._id));\n    });\n    i0.ɵɵtext(10, \"\\u00D7\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const p_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"http://localhost:3010/api/products/image/\", p_r12.name, \".png\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r12.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", p_r12.amount, \" pcs\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 4, p_r12.price));\n  }\n}\n\nfunction ShoppingCartComponent_div_0_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵtemplate(1, ShoppingCartComponent_div_0_div_10_button_1_Template, 11, 6, \"button\", 14);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r7.shoppingCartProducts);\n  }\n}\n\nfunction ShoppingCartComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"li\", 4);\n    i0.ɵɵtext(2, \" Shopping Cart \");\n    i0.ɵɵtemplate(3, ShoppingCartComponent_div_0_span_3_Template, 2, 1, \"span\", 5);\n    i0.ɵɵelementStart(4, \"span\", 6);\n    i0.ɵɵlistener(\"click\", function ShoppingCartComponent_div_0_Template_span_click_4_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.collapse());\n    });\n    i0.ɵɵtext(5, \"highlight_off\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 7);\n    i0.ɵɵtemplate(7, ShoppingCartComponent_div_0_p_7_Template, 2, 0, \"p\", 8);\n    i0.ɵɵtemplate(8, ShoppingCartComponent_div_0_p_8_Template, 2, 0, \"p\", 8);\n    i0.ɵɵtemplate(9, ShoppingCartComponent_div_0_div_9_Template, 8, 0, \"div\", 8);\n    i0.ɵɵtemplate(10, ShoppingCartComponent_div_0_div_10_Template, 2, 1, \"div\", 9);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.user);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.user);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.shoppingCartProducts && ctx_r0.user && !ctx_r0.cartOption);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.cartOption && ctx_r0.user);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.user && !ctx_r0.cartOption);\n  }\n}\n\nfunction ShoppingCartComponent_li_1_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ShoppingCartComponent_li_1_button_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r20.clearCart());\n    });\n    i0.ɵɵtext(1, \"Clear cart\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ShoppingCartComponent_li_1_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 25);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total Price : \", i0.ɵɵpipeBind1(2, 1, ctx_r18.totalPrice), \"\");\n  }\n}\n\nfunction ShoppingCartComponent_li_1_a_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 26)(1, \"button\", 27);\n    i0.ɵɵtext(2, \"Purchase\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction ShoppingCartComponent_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 19)(1, \"div\", 20);\n    i0.ɵɵtemplate(2, ShoppingCartComponent_li_1_button_2_Template, 2, 0, \"button\", 21);\n    i0.ɵɵtemplate(3, ShoppingCartComponent_li_1_p_3_Template, 3, 3, \"p\", 22);\n    i0.ɵɵtemplate(4, ShoppingCartComponent_li_1_a_4_Template, 3, 0, \"a\", 23);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.shoppingCartProducts.length !== 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.shoppingCartProducts.length !== 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.shoppingCartProducts.length !== 0);\n  }\n}\n\nfunction ShoppingCartComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 28)(1, \"li\", 4);\n    i0.ɵɵtext(2, \" Shopping Cart \");\n    i0.ɵɵelementStart(3, \"span\", 6);\n    i0.ɵɵlistener(\"click\", function ShoppingCartComponent_div_2_Template_span_click_3_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.collapse());\n    });\n    i0.ɵɵtext(4, \"add_circle_outline\");\n    i0.ɵɵelementEnd()()();\n  }\n}\n\nexport class ShoppingCartComponent {\n  constructor(myShoppingService) {\n    this.myShoppingService = myShoppingService;\n    this.user = store.getState().user;\n    this.shoppingCartOpen = true;\n    this.shoppingCartProducts = [];\n    this.cartOption = false;\n    this.userActive = false;\n  }\n\n  ngOnInit() {\n    //get state from redux.\n    store.subscribe(() => {\n      this.user = store.getState().user;\n      this.shoppingCartProducts = store.getState().productsOfCart;\n      this.totalPrice = store.getState().totalPrice;\n      this.userActive = store.getState().userActive;\n      this.cartOption = store.getState().cartOption;\n    });\n    const localCart = localStorage.getItem(\"myCart\");\n    setTimeout(() => {\n      if (!this.cart && !localCart) {\n        if (this.user) {\n          this.createCart();\n        }\n      }\n    }, 5000); //if you have cart in localStorage\n\n    if (localCart && !this.userActive) {\n      const action = {\n        type: ActionType.updateUserActive,\n        payload: true\n      };\n      store.dispatch(action);\n      this.cart = JSON.parse(localCart);\n      store.dispatch({\n        type: ActionType.updateCartOption,\n        payload: true\n      });\n    }\n  }\n\n  createCart() {\n    this.myShoppingService.createCart({\n      _id: this.user._id\n    }).subscribe(res => {\n      this.cart = res;\n      localStorage.setItem(\"myCart\", JSON.stringify(res));\n    }, err => alert(err.message));\n  }\n\n  continueShopping() {\n    // --- get all products of cart ----- //\n    const localCart = localStorage.getItem(\"myCart\");\n    this.myShoppingService.getAllProducts({\n      cartId: JSON.parse(localCart)._id\n    }).subscribe(res => {\n      const action = {\n        type: ActionType.getAllProductsOfCart,\n        payload: res\n      };\n      store.dispatch(action);\n      store.dispatch({\n        type: ActionType.updateCartOption,\n        payload: false\n      });\n      this.getTotalPrice();\n    }, err => alert(err.message));\n  }\n\n  getTotalPrice() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const totalPrice = _this.myShoppingService.getTotalPrice(_this.shoppingCartProducts);\n\n      const action = yield {\n        type: ActionType.updateTotalPrice,\n        payload: totalPrice\n      };\n      store.dispatch(action);\n    })();\n  }\n\n  clearCart() {\n    const answer = window.confirm(\"Are you sure?\");\n\n    if (!answer) {\n      return;\n    }\n\n    const myCart = this.cart;\n    this.myShoppingService.deleteCart(myCart).subscribe(() => {\n      localStorage.removeItem(\"myCart\");\n      this.createCart();\n      store.dispatch({\n        type: ActionType.updateCartOption,\n        payload: false\n      });\n      const action = {\n        type: ActionType.getAllProductsOfCart\n      };\n      store.dispatch(action);\n    }, err => alert(err.message));\n  } //--- open / close shopping cart\n\n\n  collapse() {\n    const productsDiv = document.getElementById(\"productsDiv\");\n\n    if (this.shoppingCartOpen) {\n      this.shoppingCartOpen = false;\n      productsDiv.style.width = \"80%\";\n    } else {\n      this.shoppingCartOpen = true;\n      productsDiv.style.width = \"70%\";\n    }\n  }\n\n  removeProductFromCart(_id) {\n    //remove from db and redux.\n    this.myShoppingService.removeFromCart(_id).subscribe(() => {\n      const action = {\n        type: ActionType.removeFromCart,\n        payload: _id\n      };\n      store.dispatch(action);\n    }, err => alert(err.message)); //update total price\n\n    setTimeout(() => {\n      this.getTotalPrice();\n    }, 2000);\n  }\n\n}\n\nShoppingCartComponent.ɵfac = function ShoppingCartComponent_Factory(t) {\n  return new (t || ShoppingCartComponent)(i0.ɵɵdirectiveInject(i1.ShoppingCartService));\n};\n\nShoppingCartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ShoppingCartComponent,\n  selectors: [[\"app-shopping-cart\"]],\n  decls: 3,\n  vars: 3,\n  consts: [[\"class\", \"shoppingCartDiv\", 4, \"ngIf\"], [\"class\", \"list-group-item active\", \"id\", \"endOfCart\", 4, \"ngIf\"], [\"class\", \"shoppingCartDivClosed\", 4, \"ngIf\"], [1, \"shoppingCartDiv\"], [1, \"list-group-item\", \"active\"], [\"class\", \"badge badge-light\", 4, \"ngIf\"], [\"id\", \"closeBtnCart\", 1, \"material-icons\", 3, \"click\"], [1, \"cart\"], [4, \"ngIf\"], [\"class\", \"list-group\", 4, \"ngIf\"], [1, \"badge\", \"badge-light\"], [\"type\", \"button\", 1, \"btn\", \"btn-info\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"list-group\"], [\"type\", \"button\", \"class\", \"list-group-item list-group-item-action\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"list-group-item\", \"list-group-item-action\"], [3, \"src\"], [1, \"badge\", \"badge-primary\", \"badge-pill\"], [\"aria-hidden\", \"true\", \"id\", \"closeBtn\", 3, \"click\"], [\"id\", \"endOfCart\", 1, \"list-group-item\", \"active\"], [1, \"row\"], [\"type\", \"button\", \"class\", \"btn btn-warning col-md-4\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"col-md-4\", 4, \"ngIf\"], [\"class\", \" col-md-4\", \"routerLink\", \"/payment\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", \"btn-warning\", \"col-md-4\", 3, \"click\"], [1, \"col-md-4\"], [\"routerLink\", \"/payment\", 1, \"col-md-4\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\"], [1, \"shoppingCartDivClosed\"]],\n  template: function ShoppingCartComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, ShoppingCartComponent_div_0_Template, 11, 5, \"div\", 0);\n      i0.ɵɵtemplate(1, ShoppingCartComponent_li_1_Template, 5, 3, \"li\", 1);\n      i0.ɵɵtemplate(2, ShoppingCartComponent_div_2_Template, 5, 0, \"div\", 2);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.shoppingCartOpen);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.shoppingCartOpen && ctx.user && !ctx.cartOption);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.shoppingCartOpen);\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i3.RouterLinkWithHref, i2.CurrencyPipe],\n  styles: [\".shoppingCartDiv[_ngcontent-%COMP%] {\\n    border: 2px solid #ccc9c9;\\n    height: 320px;\\n    overflow: auto;\\n}\\n\\nh2[_ngcontent-%COMP%] {\\n    border-bottom: 1px solid #ccc9c9;\\n    margin: 0;\\n}\\n\\n.openButton[_ngcontent-%COMP%] {\\n    margin: 0;\\n    font-size: 80px;\\n    position: absolute;\\n    left: 400px;\\n    top: 550px;\\n    color: #413C58;\\n}\\n\\n.shoppingCartDivClosed[_ngcontent-%COMP%]{\\n    width: 50%;\\n}\\n\\n#openButton[_ngcontent-%COMP%] {\\n    font-size: 30px;\\n}\\n\\n.list-group[_ngcontent-%COMP%]    > .list-group-item[_ngcontent-%COMP%] {\\n    display: inline-flex!important;\\n}\\n\\n.list-group-item[_ngcontent-%COMP%] > p[_ngcontent-%COMP%] {\\n    margin: 15px 60px 0 60px;\\n}\\n\\n.list-group[_ngcontent-%COMP%]    > .list-group-item[_ngcontent-%COMP%] > .badge[_ngcontent-%COMP%] {\\n    font-weight: 200;\\n    margin-top: 15px;\\n}\\n\\n.list-group-item[_ngcontent-%COMP%] > img[_ngcontent-%COMP%] {\\n    height: 50px;\\n}\\n\\n.list-group-item[_ngcontent-%COMP%] > #closeBtn[_ngcontent-%COMP%] {\\n    position: absolute;\\n    right: 5px;\\n    font-size: 30px;\\n    top: 25px;\\n}\\n\\n#endOfCart[_ngcontent-%COMP%]    > p[_ngcontent-%COMP%] {\\n    margin: 0;\\n}\\n\\n#closeBtnCart[_ngcontent-%COMP%]{\\n    float: right;\\n}\\n\\n#closeBtnCart[_ngcontent-%COMP%]:hover{\\n    cursor: pointer;\\n}\\n\\n[_ngcontent-%COMP%]::-webkit-scrollbar {\\n    width: 10px;\\n}\\n\\n[_ngcontent-%COMP%]::-webkit-scrollbar-track {\\n    background: #f1f1f1;\\n}\\n\\n[_ngcontent-%COMP%]::-webkit-scrollbar-thumb {\\n    background: #888;\\n}\\n\\n[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover {\\n    background: #555;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNob3BwaW5nLWNhcnQuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLHlCQUF5QjtJQUN6QixhQUFhO0lBQ2IsY0FBYztBQUNsQjs7QUFFQTtJQUNJLGdDQUFnQztJQUNoQyxTQUFTO0FBQ2I7O0FBRUE7SUFDSSxTQUFTO0lBQ1QsZUFBZTtJQUNmLGtCQUFrQjtJQUNsQixXQUFXO0lBQ1gsVUFBVTtJQUNWLGNBQWM7QUFDbEI7O0FBQ0E7SUFDSSxVQUFVO0FBQ2Q7O0FBQ0E7SUFDSSxlQUFlO0FBQ25COztBQUVBO0lBQ0ksOEJBQThCO0FBQ2xDOztBQUVBO0lBQ0ksd0JBQXdCO0FBQzVCOztBQUVBO0lBQ0ksZ0JBQWdCO0lBQ2hCLGdCQUFnQjtBQUNwQjs7QUFFQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxrQkFBa0I7SUFDbEIsVUFBVTtJQUNWLGVBQWU7SUFDZixTQUFTO0FBQ2I7O0FBQ0E7SUFDSSxTQUFTO0FBQ2I7O0FBQ0E7SUFDSSxZQUFZO0FBQ2hCOztBQUNBO0lBQ0ksZUFBZTtBQUNuQjs7QUFDQTtJQUNJLFdBQVc7QUFDZjs7QUFFQTtJQUNJLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLGdCQUFnQjtBQUNwQjs7QUFFQTtJQUNJLGdCQUFnQjtBQUNwQiIsImZpbGUiOiJzaG9wcGluZy1jYXJ0LmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuc2hvcHBpbmdDYXJ0RGl2IHtcbiAgICBib3JkZXI6IDJweCBzb2xpZCAjY2NjOWM5O1xuICAgIGhlaWdodDogMzIwcHg7XG4gICAgb3ZlcmZsb3c6IGF1dG87XG59XG5cbmgyIHtcbiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2NjYzljOTtcbiAgICBtYXJnaW46IDA7XG59XG5cbi5vcGVuQnV0dG9uIHtcbiAgICBtYXJnaW46IDA7XG4gICAgZm9udC1zaXplOiA4MHB4O1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICBsZWZ0OiA0MDBweDtcbiAgICB0b3A6IDU1MHB4O1xuICAgIGNvbG9yOiAjNDEzQzU4O1xufVxuLnNob3BwaW5nQ2FydERpdkNsb3NlZHtcbiAgICB3aWR0aDogNTAlO1xufVxuI29wZW5CdXR0b24ge1xuICAgIGZvbnQtc2l6ZTogMzBweDtcbn1cblxuLmxpc3QtZ3JvdXAgPiAubGlzdC1ncm91cC1pdGVtIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtZmxleCFpbXBvcnRhbnQ7XG59XG5cbi5saXN0LWdyb3VwLWl0ZW0+cCB7XG4gICAgbWFyZ2luOiAxNXB4IDYwcHggMCA2MHB4O1xufVxuXG4ubGlzdC1ncm91cCA+IC5saXN0LWdyb3VwLWl0ZW0+LmJhZGdlIHtcbiAgICBmb250LXdlaWdodDogMjAwO1xuICAgIG1hcmdpbi10b3A6IDE1cHg7XG59XG5cbi5saXN0LWdyb3VwLWl0ZW0+aW1nIHtcbiAgICBoZWlnaHQ6IDUwcHg7XG59XG5cbi5saXN0LWdyb3VwLWl0ZW0+I2Nsb3NlQnRuIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgcmlnaHQ6IDVweDtcbiAgICBmb250LXNpemU6IDMwcHg7XG4gICAgdG9wOiAyNXB4O1xufVxuI2VuZE9mQ2FydCA+IHAge1xuICAgIG1hcmdpbjogMDtcbn1cbiNjbG9zZUJ0bkNhcnR7XG4gICAgZmxvYXQ6IHJpZ2h0O1xufVxuI2Nsb3NlQnRuQ2FydDpob3ZlcntcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG59XG46Oi13ZWJraXQtc2Nyb2xsYmFyIHtcbiAgICB3aWR0aDogMTBweDtcbn1cblxuOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7XG4gICAgYmFja2dyb3VuZDogI2YxZjFmMTtcbn1cblxuOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XG4gICAgYmFja2dyb3VuZDogIzg4ODtcbn1cblxuOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjpob3ZlciB7XG4gICAgYmFja2dyb3VuZDogIzU1NTtcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":";AAEA,SAASA,KAAT,QAAsB,qBAAtB;AAIA,SAASC,UAAT,QAA2B,2BAA3B;;;;;;;;ICJsBC;IAA6CA;IAA+BA;;;;;IAA/BA;IAAAA;;;;;;IAI3DA;IAAiBA;IAAyBA;;;;;;IAC1CA;IAAwDA;IAA2BA;;;;;;;;IACnFA;IACIA;IACAA;IAA2CA;MAAAA;MAAA;MAAA,OAASA,yCAAT;IAA2B,CAA3B;IAA6BA;IAChEA;IACRA,sBAAI,CAAJ,EAAI,IAAJ;IACAA;IAAgDA;MAAAA;MAAA;MAAA,OAASA,mCAAT;IAAoB,CAApB;IAAsBA;IAAQA;;;;;;;;IAG9EA;IACIA;IACAA;IAAGA;IAAUA;IACbA;IAA6CA;IAAgBA;IAC7DA;IAAGA;;IAAsBA;IACzBA;IAAuCA;MAAA;MAAA;MAAA;MAAA,OAASA,wDAAT;IAAqC,CAArC;IAAuCA;IAAOA;;;;;IAJhFA;IAAAA;IACFA;IAAAA;IAC0CA;IAAAA;IAC1CA;IAAAA;;;;;;IALXA;IACIA;IAOJA;;;;;IAPuFA;IAAAA;;;;;;;;IAhB/FA,+BAAsD,CAAtD,EAAsD,IAAtD,EAAsD,CAAtD;IAEQA;IAAcA;IACdA;IAA+CA;MAAAA;MAAA;MAAA,OAASA,kCAAT;IAAmB,CAAnB;IAAqBA;IAAaA;IAErFA;IACIA;IACAA;IACAA;IAOAA;IASJA;;;;;IAtByBA;IAAAA;IAIjBA;IAAAA;IACAA;IAAAA;IACEA;IAAAA;IAOmBA;IAAAA;;;;;;;;IAazBA;IACIA;MAAAA;MAAA;MAAA,OAASA,mCAAT;IAAoB,CAApB;IAAsBA;IAAUA;;;;;;IACpCA;IAA8DA;;IAAuCA;;;;;IAAvCA;IAAAA;;;;;;IAC9DA,8BAAqF,CAArF,EAAqF,QAArF,EAAqF,EAArF;IACkDA;IAAQA;;;;;;IANlEA,+BAAkG,CAAlG,EAAkG,KAAlG,EAAkG,EAAlG;IAEQA;IAEAA;IACAA;IAIJA;;;;;IAP2BA;IAAAA;IAEFA;IAAAA;IACuBA;IAAAA;;;;;;;;IAMpDA,gCAA6D,CAA7D,EAA6D,IAA7D,EAA6D,CAA7D;IAEQA;IACAA;IAA+CA;MAAAA;MAAA;MAAA,OAASA,kCAAT;IAAmB,CAAnB;IAAqBA;IAAkBA;;;;AD3B9F,OAAM,MAAOC,qBAAP,CAA4B;EAUhCC,YAAoBC,iBAApB,EAA0D;IAAtC;IATb,YAAkBL,KAAK,CAACM,QAAN,GAAiBC,IAAnC;IACA,wBAA4B,IAA5B;IACA,4BAAqC,EAArC;IAIA,kBAAa,KAAb;IACA,kBAAsB,KAAtB;EAEwD;;EAE/DC,QAAQ;IACN;IACAR,KAAK,CAACS,SAAN,CAAgB,MAAK;MACnB,KAAKF,IAAL,GAAYP,KAAK,CAACM,QAAN,GAAiBC,IAA7B;MACA,KAAKG,oBAAL,GAA4BV,KAAK,CAACM,QAAN,GAAiBK,cAA7C;MACA,KAAKC,UAAL,GAAkBZ,KAAK,CAACM,QAAN,GAAiBM,UAAnC;MACA,KAAKC,UAAL,GAAkBb,KAAK,CAACM,QAAN,GAAiBO,UAAnC;MACA,KAAKC,UAAL,GAAkBd,KAAK,CAACM,QAAN,GAAiBQ,UAAnC;IACD,CAND;IASA,MAAMC,SAAS,GAAGC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAlB;IAEAC,UAAU,CAAC,MAAK;MACd,IAAI,CAAC,KAAKC,IAAN,IAAc,CAACJ,SAAnB,EAA8B;QAC5B,IAAI,KAAKR,IAAT,EAAe;UACb,KAAKa,UAAL;QACD;MACF;IACF,CANS,EAMP,IANO,CAAV,CAbM,CAoBN;;IACA,IAAIL,SAAS,IAAI,CAAC,KAAKF,UAAvB,EAAmC;MACjC,MAAMQ,MAAM,GAAG;QAAEC,IAAI,EAAErB,UAAU,CAACsB,gBAAnB;QAAqCC,OAAO,EAAE;MAA9C,CAAf;MACAxB,KAAK,CAACyB,QAAN,CAAeJ,MAAf;MACA,KAAKF,IAAL,GAAYO,IAAI,CAACC,KAAL,CAAWZ,SAAX,CAAZ;MACAf,KAAK,CAACyB,QAAN,CAAe;QAAEH,IAAI,EAAErB,UAAU,CAAC2B,gBAAnB;QAAqCJ,OAAO,EAAE;MAA9C,CAAf;IACD;EACF;;EAEMJ,UAAU;IACf,KAAKf,iBAAL,CAAuBe,UAAvB,CAAkC;MAAES,GAAG,EAAE,KAAKtB,IAAL,CAAUsB;IAAjB,CAAlC,EACGpB,SADH,CACaqB,GAAG,IAAG;MACf,KAAKX,IAAL,GAAYW,GAAZ;MACAd,YAAY,CAACe,OAAb,CAAqB,QAArB,EAA+BL,IAAI,CAACM,SAAL,CAAeF,GAAf,CAA/B;IACD,CAJH,EAIKG,GAAG,IAAIC,KAAK,CAACD,GAAG,CAACE,OAAL,CAJjB;EAKD;;EAEMC,gBAAgB;IACrB;IACA,MAAMrB,SAAS,GAAGC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAlB;IACA,KAAKZ,iBAAL,CAAuBgC,cAAvB,CAAsC;MAAEC,MAAM,EAAEZ,IAAI,CAACC,KAAL,CAAWZ,SAAX,EAAsBc;IAAhC,CAAtC,EACGpB,SADH,CACaqB,GAAG,IAAG;MACf,MAAMT,MAAM,GAAG;QAAEC,IAAI,EAAErB,UAAU,CAACsC,oBAAnB;QAAyCf,OAAO,EAAEM;MAAlD,CAAf;MACA9B,KAAK,CAACyB,QAAN,CAAeJ,MAAf;MACArB,KAAK,CAACyB,QAAN,CAAe;QAAEH,IAAI,EAAErB,UAAU,CAAC2B,gBAAnB;QAAqCJ,OAAO,EAAE;MAA9C,CAAf;MACA,KAAKgB,aAAL;IACD,CANH,EAMKP,GAAG,IAAIC,KAAK,CAACD,GAAG,CAACE,OAAL,CANjB;EAOD;;EAEYK,aAAa;IAAA;;IAAA;MACxB,MAAM5B,UAAU,GAAI,KAAI,CAACP,iBAAL,CAAuBmC,aAAvB,CAAqC,KAAI,CAAC9B,oBAA1C,CAApB;;MACA,MAAMW,MAAM,SAAS;QAAEC,IAAI,EAAErB,UAAU,CAACwC,gBAAnB;QAAqCjB,OAAO,EAAEZ;MAA9C,CAArB;MACAZ,KAAK,CAACyB,QAAN,CAAeJ,MAAf;IAHwB;EAIzB;;EACMqB,SAAS;IACd,MAAMC,MAAM,GAAGC,MAAM,CAACC,OAAP,CAAe,eAAf,CAAf;;IACA,IAAI,CAACF,MAAL,EAAa;MACX;IACD;;IACD,MAAMG,MAAM,GAAQ,KAAK3B,IAAzB;IACA,KAAKd,iBAAL,CAAuB0C,UAAvB,CAAkCD,MAAlC,EACGrC,SADH,CACa,MAAI;MACbO,YAAY,CAACgC,UAAb,CAAwB,QAAxB;MACA,KAAK5B,UAAL;MACApB,KAAK,CAACyB,QAAN,CAAe;QAAEH,IAAI,EAAErB,UAAU,CAAC2B,gBAAnB;QAAqCJ,OAAO,EAAE;MAA9C,CAAf;MACA,MAAMH,MAAM,GAAG;QAAEC,IAAI,EAAErB,UAAU,CAACsC;MAAnB,CAAf;MACAvC,KAAK,CAACyB,QAAN,CAAeJ,MAAf;IACD,CAPH,EAOKY,GAAG,IAAIC,KAAK,CAACD,GAAG,CAACE,OAAL,CAPjB;EAQD,CAhF+B,CAmFhC;;;EACOc,QAAQ;IACb,MAAMC,WAAW,GAAGC,QAAQ,CAACC,cAAT,CAAwB,aAAxB,CAApB;;IACA,IAAI,KAAKC,gBAAT,EAA2B;MAAE,KAAKA,gBAAL,GAAwB,KAAxB;MAA+BH,WAAW,CAACI,KAAZ,CAAkBC,KAAlB,GAA0B,KAA1B;IAAiC,CAA7F,MACK;MAAE,KAAKF,gBAAL,GAAwB,IAAxB;MAA8BH,WAAW,CAACI,KAAZ,CAAkBC,KAAlB,GAA0B,KAA1B;IAAiC;EACvE;;EAEMC,qBAAqB,CAAC3B,GAAD,EAAY;IACtC;IACA,KAAKxB,iBAAL,CAAuBoD,cAAvB,CAAsC5B,GAAtC,EACGpB,SADH,CACa,MAAK;MACd,MAAMY,MAAM,GAAG;QAAEC,IAAI,EAAErB,UAAU,CAACwD,cAAnB;QAAmCjC,OAAO,EAAEK;MAA5C,CAAf;MACA7B,KAAK,CAACyB,QAAN,CAAeJ,MAAf;IACD,CAJH,EAIKY,GAAG,IAAIC,KAAK,CAACD,GAAG,CAACE,OAAL,CAJjB,EAFsC,CAOtC;;IACAjB,UAAU,CAAC,MAAK;MACd,KAAKsB,aAAL;IACD,CAFS,EAEP,IAFO,CAAV;EAGD;;AArG+B;;;mBAArBrC,uBAAqBD;AAAA;;;QAArBC;EAAqBuD;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCblC5D;MA0BAA;MAWAA;;;;MArC8BA;MA0BzBA;MAAAA;MAW+BA;MAAAA","names":["store","ActionType","i0","ShoppingCartComponent","constructor","myShoppingService","getState","user","ngOnInit","subscribe","shoppingCartProducts","productsOfCart","totalPrice","userActive","cartOption","localCart","localStorage","getItem","setTimeout","cart","createCart","action","type","updateUserActive","payload","dispatch","JSON","parse","updateCartOption","_id","res","setItem","stringify","err","alert","message","continueShopping","getAllProducts","cartId","getAllProductsOfCart","getTotalPrice","updateTotalPrice","clearCart","answer","window","confirm","myCart","deleteCart","removeItem","collapse","productsDiv","document","getElementById","shoppingCartOpen","style","width","removeProductFromCart","removeFromCart","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\Natan\\Desktop\\Project 4\\Frontend\\src\\app\\components\\shopping-cart\\shopping-cart.component.ts","C:\\Users\\Natan\\Desktop\\Project 4\\Frontend\\src\\app\\components\\shopping-cart\\shopping-cart.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { UserModel } from 'src/app/models/user';\nimport { store } from 'src/app/redux/store';\nimport { CartDetail } from 'src/app/models/cart-detail';\nimport { Cart } from 'src/app/models/cart';\nimport { ShoppingCartService } from 'src/app/services/shopping-cart.service';\nimport { ActionType } from 'src/app/redux/action-type';\n\n@Component({\n  selector: 'app-shopping-cart',\n  templateUrl: './shopping-cart.component.html',\n  styleUrls: ['./shopping-cart.component.css']\n})\nexport class ShoppingCartComponent implements OnInit {\n  public user: UserModel = store.getState().user;\n  public shoppingCartOpen: boolean = true;\n  public shoppingCartProducts: CartDetail[] = [];\n  // use string type for get the cart from localStorage\n  public cart: any;\n  public totalPrice: number;\n  public cartOption = false;\n  public userActive: boolean = false;\n\n  constructor(private myShoppingService: ShoppingCartService) { }\n\n  ngOnInit(): void {\n    //get state from redux.\n    store.subscribe(() => {\n      this.user = store.getState().user;\n      this.shoppingCartProducts = store.getState().productsOfCart;\n      this.totalPrice = store.getState().totalPrice;\n      this.userActive = store.getState().userActive;\n      this.cartOption = store.getState().cartOption;\n    });\n   \n\n    const localCart = localStorage.getItem(\"myCart\");\n\n    setTimeout(() => {\n      if (!this.cart && !localCart) {\n        if (this.user) {\n          this.createCart();\n        }\n      }\n    }, 5000);\n    //if you have cart in localStorage\n    if (localCart && !this.userActive) {\n      const action = { type: ActionType.updateUserActive, payload: true };\n      store.dispatch(action);\n      this.cart = JSON.parse(localCart);\n      store.dispatch({ type: ActionType.updateCartOption, payload: true });\n    }\n  }\n\n  public createCart(): void {\n    this.myShoppingService.createCart({ _id: this.user._id })\n      .subscribe(res => {\n        this.cart = res;\n        localStorage.setItem(\"myCart\", JSON.stringify(res));\n      }, err => alert(err.message));\n  }\n\n  public continueShopping(): void {\n    // --- get all products of cart ----- //\n    const localCart = localStorage.getItem(\"myCart\");\n    this.myShoppingService.getAllProducts({ cartId: JSON.parse(localCart)._id })\n      .subscribe(res => {\n        const action = { type: ActionType.getAllProductsOfCart, payload: res };\n        store.dispatch(action);\n        store.dispatch({ type: ActionType.updateCartOption, payload: false });\n        this.getTotalPrice();\n      }, err => alert(err.message));\n  }\n\n  public async getTotalPrice() {\n    const totalPrice =  this.myShoppingService.getTotalPrice(this.shoppingCartProducts);\n    const action = await { type: ActionType.updateTotalPrice, payload: totalPrice };\n    store.dispatch(action);\n  }\n  public clearCart(): void {\n    const answer = window.confirm(\"Are you sure?\");\n    if (!answer) {\n      return;\n    }\n    const myCart: any = this.cart;\n    this.myShoppingService.deleteCart(myCart)\n      .subscribe(()=> {\n        localStorage.removeItem(\"myCart\");\n        this.createCart();\n        store.dispatch({ type: ActionType.updateCartOption, payload: false });\n        const action = { type: ActionType.getAllProductsOfCart,};\n        store.dispatch(action);\n      }, err => alert(err.message));\n  }\n\n\n  //--- open / close shopping cart\n  public collapse(): void {\n    const productsDiv = document.getElementById(\"productsDiv\");\n    if (this.shoppingCartOpen) { this.shoppingCartOpen = false; productsDiv.style.width = \"80%\" }\n    else { this.shoppingCartOpen = true; productsDiv.style.width = \"70%\" }\n  }\n\n  public removeProductFromCart(_id: string): void {\n    //remove from db and redux.\n    this.myShoppingService.removeFromCart(_id)\n      .subscribe(() => {\n        const action = { type: ActionType.removeFromCart, payload: _id };\n        store.dispatch(action);\n      }, err => alert(err.message));\n    //update total price\n    setTimeout(() => {\n      this.getTotalPrice();\n    }, 2000);\n  }\n\n}\n","<div class=\"shoppingCartDiv\" *ngIf='shoppingCartOpen'>\n    <li class=\"list-group-item active\">\n        Shopping Cart <span *ngIf='user' class=\"badge badge-light\">{{shoppingCartProducts.length}}</span>\n        <span class=\"material-icons\" id='closeBtnCart' (click)='collapse()'>highlight_off</span>\n    </li>\n    <div class=\"cart\">\n        <p *ngIf='!user'>Please Login / Register .</p>\n        <p *ngIf='!shoppingCartProducts && user && !cartOption'>Your shopping cart is empty</p>\n        <div *ngIf='cartOption && user'>\n            <br>\n            <button type=\"button\" class=\"btn btn-info\" (click)='continueShopping()'>Continue shopping with the previous\n                cart</button>\n            <br><br>\n            <button type=\"button\" class=\"btn btn-secondary\" (click)='clearCart()'>New cart</button>\n        </div>\n        <div class=\"list-group\" *ngIf='user && !cartOption'>\n            <button type=\"button\" class=\"list-group-item list-group-item-action\" *ngFor=\"let p of shoppingCartProducts\">\n                <img src='http://localhost:3010/api/products/image/{{p.name}}.png'>\n                <p>{{p.name}}</p>\n                <span class=\"badge badge-primary badge-pill\">{{p.amount}} pcs</span>\n                <p>{{p.price | currency}}</p>\n                <span aria-hidden=\"true\" id='closeBtn' (click)='removeProductFromCart(p._id)'>&times;</span>\n            </button>\n        </div>\n    </div>\n</div>\n<li *ngIf='shoppingCartOpen && user && !cartOption' class=\"list-group-item active\" id=\"endOfCart\">\n    <div class=\"row\">\n        <button type=\"button\" *ngIf='shoppingCartProducts.length !== 0' class=\"btn btn-warning col-md-4\"\n            (click)='clearCart()'>Clear cart</button>\n        <p class=\"col-md-4\" *ngIf='shoppingCartProducts.length !== 0'>Total Price : {{totalPrice | currency}}</p>\n        <a class=\" col-md-4\" routerLink=\"/payment\" *ngIf='shoppingCartProducts.length !== 0'>\n            <button type=\"button\" class=\"btn btn-success\">Purchase</button>\n        </a>\n\n    </div>\n</li>\n<div class=\"shoppingCartDivClosed\" *ngIf='!shoppingCartOpen'>\n    <li class=\"list-group-item active\">\n        Shopping Cart\n        <span class=\"material-icons\" id='closeBtnCart' (click)='collapse()'>add_circle_outline</span>\n    </li>\n</div>"]},"metadata":{},"sourceType":"module"}